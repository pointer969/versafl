/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Popup","sap/ui/core/BusyIndicator","sap/base/Log","sap/ui/dt/Util","sap/m/InstanceManager","sap/base/util/includes"],function(P,B,L,U,I,i){"use strict";var Z=10;var a=3;var A=[];var _=[];var g=function(){return I.getOpenDialogs().concat(I.getOpenPopovers(),B.oPopup&&B.oPopup.isOpen()?[B.oPopup]:[]);};var G=function(c,m,e){if(++c<=m){if(i(e,c)){return G(c,m,e);}return c;}else{L.error('sap.ui.dt.util.ZIndexManager: z-index limit has been exceeded, therefore all following calls receive the same z-Index = '+m);return m;}};var f=function(p){return p.map(function(o){return o._iZIndex||o.oPopup._iZIndex;});};var b={getNextZIndex:function(){var c=g();var v=[];var d=[];c.forEach(function(o){var V=_.every(function(F){return F(o);});V&&_.length>0?v.push(o):d.push(o);});var m=v.length>0?Math.max.apply(null,f(v)):-1;var M=d.length>0?Math.min.apply(null,f(d)):-1;if(m<M){return this._getNextMinZIndex(M);}else{return P.getNextZIndex();}},getZIndexBelowPopups:function(){var o=g();var l;if(o.length>0){l=Math.min.apply(null,f(o));}if(!U.isInteger(l)){return P.getNextZIndex();}return this._getNextMinZIndex(l);},addPopupFilter:function(F){if(typeof F==="function"){_=_.concat([F]);}},removePopupFilter:function(F){_=_.filter(function(e){return e===F;});},_getNextMinZIndex:function(c){var m=c-a;var M=c-Z;var n=G(M,m,A);A.push(n);return n;}};return b;});
